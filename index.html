<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>Akarat Tunisia | Emlak ƒ∞lanlarƒ±</title>
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Leaflet CSS (Harita i√ßin) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* Reset ve Temel Stiller */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: #f8fafc;
            color: #1e293b;
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Container */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
            width: 100%;
        }

        /* Header & Navigation (Toolbar) - Mevcut ≈üƒ±k tasarƒ±m korundu */
        .header {
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
            position: sticky;
            top: 0;
            z-index: 50;
            border-bottom: 1px solid #eef2f6;
        }

        .header .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
            padding: 0 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }
        .logo i {
            font-size: 32px;
            color: #2563eb;
        }
        .logo span {
            font-size: 22px;
            font-weight: 700;
            color: #0f172a;
        }

        /* Ana Men√º */
        .main-menu {
            display: flex;
            gap: 32px;
            list-style: none;
        }
        .main-menu li a {
            text-decoration: none;
            color: #475569;
            font-weight: 500;
            font-size: 15px;
            transition: color 0.2s;
            cursor: pointer;
            padding: 8px 0;
            border-bottom: 2px solid transparent;
        }
        .main-menu li a:hover {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }
        .main-menu li a.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
            font-weight: 600;
        }

        /* Saƒü Men√º (Dil ve Kullanƒ±cƒ±) */
        .right-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .lang-switcher {
            display: flex;
            gap: 6px;
            background: #f1f5f9;
            padding: 4px;
            border-radius: 40px;
        }
        .lang-btn {
            background: none;
            border: none;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            color: #475569;
            transition: all 0.2s;
        }
        .lang-btn.active {
            background: white;
            color: #2563eb;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        /* Kullanƒ±cƒ± Men√ºs√º */
        .user-menu {
            position: relative;
        }
        .auth-buttons {
            display: flex;
            gap: 8px;
        }
        .auth-buttons button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 40px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
            border: 1px solid transparent;
        }
        .auth-buttons button:last-child {
            background: white;
            color: #2563eb;
            border: 1px solid #2563eb;
        }
        .auth-buttons button:last-child:hover {
            background: #eef2ff;
        }
        .auth-buttons button:first-child:hover {
            background: #1d4ed8;
        }

        #user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f1f5f9;
            padding: 6px 14px 6px 10px;
            border-radius: 40px;
            font-size: 14px;
            cursor: pointer;
        }
        #user-info i {
            font-size: 18px;
            color: #2563eb;
        }
        .admin-badge {
            background: #fbbf24;
            color: #0f172a;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 20px;
            margin-left: 6px;
        }
        .hidden { display: none !important; }

        /* Dropdown Men√º */
        .user-dropdown {
            position: relative;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            top: 48px;
            background: white;
            min-width: 200px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            border-radius: 16px;
            z-index: 100;
            border: 1px solid #eef2f6;
            overflow: hidden;
        }
        .dropdown-content a {
            color: #1e293b;
            padding: 14px 18px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .dropdown-content a:hover {
            background: #f8fafc;
        }
        .user-dropdown:hover .dropdown-content {
            display: block;
        }

        /* Filtre Paneli */
        .filter-panel {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin: 32px 0;
            border: 1px solid #eef2f6;
            box-shadow: 0 4px 12px rgba(0,0,0,0.02);
        }
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 16px;
        }
        .filter-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 4px;
        }
        .filter-group input, .filter-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            font-size: 13px;
            background: #f8fafc;
        }
        .filter-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        .filter-actions button {
            padding: 10px 24px;
            border: none;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            background: #2563eb;
            color: white;
        }
        .filter-actions button.reset-btn {
            background: #f1f5f9;
            color: #475569;
        }

        /* ƒ∞statistik Kartlarƒ± */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 40px 0;
        }
        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            border: 1px solid #eef2f6;
            box-shadow: 0 4px 12px rgba(0,0,0,0.02);
            text-align: center;
        }
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 4px;
        }
        .stat-label {
            font-size: 14px;
            color: #64748b;
        }

        /* B√∂l√ºm Ba≈ülƒ±klarƒ± */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 48px 0 24px;
        }
        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: #0f172a;
        }

        /* ƒ∞lan Listesi */
        .ads-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
        }
        .ad-card {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            border: 1px solid #eef2f6;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            position: relative;
        }
        .ad-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 30px -10px rgba(0,0,0,0.1);
        }
        .ad-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            background-color: #f1f5f9;
            position: relative;
        }
        .ad-image .favorite-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #94a3b8;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            z-index: 2;
        }
        .ad-image .favorite-btn.active {
            color: #ef4444;
        }
        .ad-content {
            padding: 20px;
        }
        .ad-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #0f172a;
        }
        .ad-location {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .ad-price {
            font-size: 22px;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 12px;
        }
        .ad-details {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: #475569;
            border-top: 1px solid #eef2f6;
            padding-top: 12px;
        }
        .ad-actions {
            position: absolute;
            bottom: 12px;
            right: 12px;
            display: flex;
            gap: 8px;
            z-index: 2;
        }
        .ad-actions button {
            background: white;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        .ad-actions button:hover {
            background: #f1f5f9;
        }

        /* Form Alanƒ± */
        .form-section {
            background: white;
            border-radius: 24px;
            padding: 32px;
            margin: 48px 0;
            border: 1px solid #eef2f6;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .form-group.full-width { grid-column: span 2; }
        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 6px;
        }
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            font-size: 14px;
            background: #f8fafc;
        }
        .form-control:focus {
            outline: none;
            border-color: #2563eb;
            background: white;
        }
        textarea.form-control { min-height: 100px; }

        .photo-upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            background: #f8fafc;
            cursor: pointer;
        }
        .photo-upload-area:hover { border-color: #2563eb; }
        .photo-upload-area i { font-size: 36px; color: #2563eb; }

        .image-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
        }
        .preview-image-wrapper {
            position: relative;
        }
        .preview-image {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            border: 1px solid #e2e8f0;
        }
        .remove-photo {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            cursor: pointer;
        }

        .btn {
            padding: 12px 28px;
            border: none;
            border-radius: 40px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary {
            background: #2563eb;
            color: white;
        }
        .btn-secondary {
            background: white;
            color: #2563eb;
            border: 1px solid #2563eb;
        }

        /* Footer */
        .footer {
            background: white;
            border-top: 1px solid #eef2f6;
            padding: 40px 0;
            margin-top: 60px;
            text-align: center;
            color: #64748b;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal.show { display: flex; }
        .modal-content {
            background: white;
            border-radius: 32px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            padding: 32px;
            position: relative;
        }
        .close-modal {
            position: absolute;
            left: 24px;
            top: 24px;
            font-size: 28px;
            cursor: pointer;
            color: #94a3b8;
        }

        /* Responsive Tasarƒ±m */
        @media (max-width: 768px) {
            .header .container {
                flex-wrap: wrap;
                height: auto;
                padding: 16px;
                gap: 16px;
            }
            .main-menu {
                flex-wrap: wrap;
                gap: 16px;
                justify-content: center;
                width: 100%;
                order: 3;
            }
            .right-menu {
                width: auto;
            }
            .stats-row {
                grid-template-columns: 1fr;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
            .form-group.full-width {
                grid-column: span 1;
            }
            .filter-grid {
                grid-template-columns: 1fr;
            }
            .ads-grid {
                grid-template-columns: 1fr;
            }
            .modal-content {
                padding: 20px;
            }
        }
        @media (max-width: 480px) {
            .logo span {
                font-size: 18px;
            }
            .auth-buttons button {
                padding: 6px 12px;
                font-size: 13px;
            }
        }

        /* Harita */
        #modal-map, #contact-map {
            height: 200px;
            border-radius: 16px;
            margin-top: 16px;
        }
        .contact-info {
            background: #f8fafc;
            padding: 16px;
            border-radius: 16px;
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo" onclick="showPage('home'); setActiveMenu('home')">
                <i class="fas fa-home"></i>
                <span>Akarat Tunisia</span>
            </div>

            <!-- Ana Men√º -->
            <ul class="main-menu">
                <li><a onclick="showPage('home'); setActiveMenu('home')" id="menu-home" class="active">Ana Sayfa</a></li>
                <li><a onclick="showPage('for-sale'); setActiveMenu('for-sale')" id="menu-for-sale">Satƒ±lƒ±klar</a></li>
                <li><a onclick="showPage('for-rent'); setActiveMenu('for-rent')" id="menu-for-rent">Kiralƒ±klar</a></li>
                <li><a onclick="showPage('favorites'); setActiveMenu('favorites')" id="menu-favorites">Favoriler</a></li>
                <li><a onclick="showPage('about'); setActiveMenu('about')" id="menu-about">Hakkƒ±mƒ±zda</a></li>
                <li><a onclick="showPage('contact'); setActiveMenu('contact')" id="menu-contact">ƒ∞leti≈üim</a></li>
                <li><a onclick="showPage('admin'); setActiveMenu('admin')" id="menu-admin" class="hidden">Admin</a></li>
            </ul>

            <!-- Saƒü Men√º -->
            <div class="right-menu">
                <div class="lang-switcher">
                    <button class="lang-btn active" onclick="changeLanguage('tr')">üáπüá∑ TR</button>
                    <button class="lang-btn" onclick="changeLanguage('ar')">üá∏üá¶ AR</button>
                </div>

                <!-- Kullanƒ±cƒ± Alanƒ± -->
                <div class="user-menu">
                    <div id="auth-buttons" class="auth-buttons">
                        <button onclick="showLoginModal()"><i class="fas fa-sign-in-alt"></i> Giri≈ü</button>
                        <button onclick="showRegisterModal()"><i class="fas fa-user-plus"></i> Kayƒ±t</button>
                    </div>
                    <div id="user-info" class="hidden user-dropdown">
                        <i class="fas fa-user-circle"></i>
                        <span id="username">Ahmet</span>
                        <span id="admin-badge" class="admin-badge hidden">Admin</span>
                        <i class="fas fa-chevron-down"></i>
                        <div class="dropdown-content">
                            <a onclick="showPage('myads')"><i class="fas fa-list"></i> ƒ∞lanlarƒ±m</a>
                            <a onclick="showPage('favorites')"><i class="fas fa-heart"></i> Favorilerim</a>
                            <a onclick="showPage('messages')"><i class="fas fa-envelope"></i> Mesajlarƒ±m</a>
                            <a onclick="showPage('profile')"><i class="fas fa-user-circle"></i> Profil</a>
                            <a id="admin-menu-item" onclick="showPage('admin')" class="hidden"><i class="fas fa-cog"></i> Admin Paneli</a>
                            <a onclick="logout()"><i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Filtre Paneli (Sadece ilan sayfalarƒ±nda g√∂r√ºn√ºr) -->
        <div id="filter-panel" class="filter-panel">
            <div class="filter-grid">
                <div class="filter-group">
                    <label>Fiyat Min</label>
                    <input type="number" id="filter-price-min" placeholder="‚Ç∫0">
                </div>
                <div class="filter-group">
                    <label>Fiyat Max</label>
                    <input type="number" id="filter-price-max" placeholder="‚Ç∫‚àû">
                </div>
                <div class="filter-group">
                    <label>≈ûehir</label>
                    <input type="text" id="filter-city" placeholder="√ñrn: Tunus">
                </div>
                <div class="filter-group">
                    <label>Semt</label>
                    <input type="text" id="filter-district" placeholder="√ñrn: Kartaca">
                </div>
                <div class="filter-group">
                    <label>ƒ∞lan Tipi</label>
                    <select id="filter-type">
                        <option value="">T√ºm√º</option>
                        <option value="sale">Satƒ±lƒ±k</option>
                        <option value="rent">Kiralƒ±k</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Oda Sayƒ±sƒ±</label>
                    <select id="filter-rooms">
                        <option value="">T√ºm√º</option>
                        <option value="1+0">1+0</option>
                        <option value="2+1">2+1</option>
                        <option value="3+1">3+1</option>
                        <option value="4+2">4+2</option>
                        <option value="5+">5+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Bina Ya≈üƒ±</label>
                    <select id="filter-age">
                        <option value="">T√ºm√º</option>
                        <option value="0">Sƒ±fƒ±r</option>
                        <option value="0-5">0-5 yƒ±l</option>
                        <option value="5-10">5-10 yƒ±l</option>
                        <option value="10-20">10-20 yƒ±l</option>
                        <option value="20+">20+ yƒ±l</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Kat</label>
                    <select id="filter-floor">
                        <option value="">T√ºm√º</option>
                        <option value="ground">Zemin</option>
                        <option value="1-3">1-3</option>
                        <option value="4-7">4-7</option>
                        <option value="8+">8+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Isƒ±tma</label>
                    <select id="filter-heating">
                        <option value="">T√ºm√º</option>
                        <option value="central">Merkezi</option>
                        <option value="combi">Kombi</option>
                        <option value="floor">Yerden</option>
                        <option value="ac">Klima</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button onclick="applyFilters()">Filtrele</button>
                <button class="reset-btn" onclick="resetFilters()">Sƒ±fƒ±rla</button>
            </div>
        </div>

        <!-- Sayfalar -->
        <!-- Ana Sayfa -->
        <div id="home-page" class="page-section">
            <div class="hero" style="background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%); border-radius: 32px; padding: 48px; color: white; margin-bottom: 40px;">
                <h1 style="font-size: 48px; font-weight: 800; margin-bottom: 16px;">Tunus'taki Yeni Evinizi Ke≈üfedin</h1>
                <p style="font-size: 18px; opacity: 0.9;">Binlerce g√ºncel ilan arasƒ±nda size en uygun olanƒ± bulun.</p>
            </div>

            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-number" id="stats-active">0</div>
                    <div class="stat-label">Aktif ƒ∞lan</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">24</div>
                    <div class="stat-label">≈ûehir</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1200+</div>
                    <div class="stat-label">Kullanƒ±cƒ±</div>
                </div>
            </div>

            <div class="section-header">
                <h2 class="section-title">√ñne √áƒ±kan ƒ∞lanlar</h2>
            </div>
            <div class="ads-grid" id="featured-ads-container"></div>

            <div class="section-header" style="margin-top: 40px;">
                <h2 class="section-title">Satƒ±lƒ±k Gayrimenkuller</h2>
            </div>
            <div class="ads-grid" id="sale-ads-container"></div>

            <div class="section-header" style="margin-top: 40px;">
                <h2 class="section-title">Kiralƒ±k Gayrimenkuller</h2>
            </div>
            <div class="ads-grid" id="rent-ads-container"></div>
        </div>

        <!-- Satƒ±lƒ±klar Sayfasƒ± -->
        <div id="for-sale-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">Satƒ±lƒ±k ƒ∞lanlar</h2>
            </div>
            <div class="ads-grid" id="for-sale-container"></div>
        </div>

        <!-- Kiralƒ±klar Sayfasƒ± -->
        <div id="for-rent-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">Kiralƒ±k ƒ∞lanlar</h2>
            </div>
            <div class="ads-grid" id="for-rent-container"></div>
        </div>

        <!-- Favoriler Sayfasƒ± -->
        <div id="favorites-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">Favori ƒ∞lanlarƒ±m</h2>
            </div>
            <div class="ads-grid" id="favorites-container"></div>
        </div>

        <!-- Hakkƒ±mƒ±zda -->
        <div id="about-page" class="page-section hidden">
            <div style="background: white; border-radius: 32px; padding: 48px; text-align: center;">
                <h2 style="font-size: 32px; margin-bottom: 24px;">Hakkƒ±mƒ±zda</h2>
                <p style="max-width: 600px; margin: 0 auto; color: #475569;">Akarat Tunisia, 20 yƒ±lƒ± a≈ükƒ±n tecr√ºbesiyle Tunus emlak piyasasƒ±nƒ±n √∂nc√º kurulu≈ülarƒ±ndan biridir. Bursam Emlak kalitesini ve g√ºvenini Tunus'a ta≈üƒ±yan vizyonumuzla, binlerce aileyi ev sahibi yaptƒ±k.</p>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin-top: 48px;">
                    <div><i class="fas fa-check-circle" style="color: #2563eb; font-size: 24px;"></i><h3 style="margin-top: 12px;">%100 ≈ûeffaf Fiyat Politikasƒ±</h3></div>
                    <div><i class="fas fa-gavel" style="color: #2563eb; font-size: 24px;"></i><h3 style="margin-top: 12px;">Uzman Hukuki Destek</h3></div>
                    <div><i class="fas fa-building" style="color: #2563eb; font-size: 24px;"></i><h3 style="margin-top: 12px;">Geni≈ü Portf√∂y Aƒüƒ±</h3></div>
                </div>
            </div>
        </div>

        <!-- ƒ∞leti≈üim -->
        <div id="contact-page" class="page-section hidden">
            <div style="background: white; border-radius: 32px; padding: 48px;">
                <h2 style="font-size: 32px; margin-bottom: 24px; text-align: center;">ƒ∞leti≈üime Ge√ßin</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                    <div>
                        <p style="margin-bottom: 16px;"><i class="fas fa-phone" style="color: #2563eb;"></i> <strong style="margin-left: 8px;">+216 71 000 000</strong></p>
                        <p style="margin-bottom: 16px;"><i class="fas fa-envelope" style="color: #2563eb;"></i> <strong style="margin-left: 8px;">info@akarat-tunisia.com</strong></p>
                        <p style="margin-bottom: 16px;"><i class="fas fa-map-marker-alt" style="color: #2563eb;"></i> <strong style="margin-left: 8px;">Tunis City Center, Tunisia</strong></p>
                    </div>
                    <div id="contact-map" style="height: 200px;"></div>
                </div>
            </div>
        </div>

        <!-- ƒ∞lanlarƒ±m Sayfasƒ± -->
        <div id="myads-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">ƒ∞lanlarƒ±m</h2>
            </div>
            <div class="ads-grid" id="myads-container"></div>
        </div>

        <!-- Mesajlar Sayfasƒ± -->
        <div id="messages-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">Mesajlarƒ±m</h2>
            </div>
            <div class="ads-list" id="messages-container" style="background: white; border-radius: 24px;"></div>
        </div>

        <!-- Profil Sayfasƒ± -->
        <div id="profile-page" class="page-section hidden">
            <div style="background: white; border-radius: 32px; padding: 48px; max-width: 400px; margin: 0 auto; text-align: center;">
                <div style="width: 100px; height: 100px; border-radius: 50%; background: #f1f5f9; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 40px;">
                    <i class="fas fa-user"></i>
                </div>
                <h3 id="profile-name" style="margin-bottom: 4px;">Ahmet Kullanƒ±cƒ±</h3>
                <p id="profile-email" style="color: #64748b; margin-bottom: 4px;">ahmet@example.com</p>
                <p id="profile-role" style="color: #64748b; margin-bottom: 20px;">Kullanƒ±cƒ±</p>
                <p>Kayƒ±tlƒ± <span id="user-ad-count">0</span> ilan</p>
            </div>
        </div>

        <!-- Admin Paneli -->
        <div id="admin-page" class="page-section hidden">
            <div class="section-header">
                <h2 class="section-title">Admin Paneli</h2>
            </div>
            <div style="background: white; border-radius: 24px; padding: 24px; margin-bottom: 24px;">
                <h3 style="margin-bottom: 16px;">Kullanƒ±cƒ±lar</h3>
                <div id="admin-users-container"></div>
            </div>
            <div style="background: white; border-radius: 24px; padding: 24px;">
                <h3 style="margin-bottom: 16px;">T√ºm ƒ∞lanlar</h3>
                <div id="admin-ads-container"></div>
            </div>
        </div>

        <!-- ƒ∞lan Ekleme/D√ºzenleme Formu (Sadece ilgili sayfalarda g√∂r√ºn√ºr) -->
        <section id="ad-form-section" class="form-section">
            <h2 class="section-title">Yeni ƒ∞lan Olu≈ütur</h2>
            <input type="hidden" id="editing-id" value="">
            <div class="form-grid">
                <div class="form-group full-width">
                    <label class="form-label">üìã Temel Bilgiler</label>
                </div>
                <div class="form-group">
                    <label class="form-label">ƒ∞lan Tipi</label>
                    <select class="form-control" id="adType">
                        <option value="sale">Satƒ±lƒ±k</option>
                        <option value="rent">Kiralƒ±k</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ba≈ülƒ±k</label>
                    <input type="text" class="form-control" id="adTitle" placeholder="√ñrn: Merkezde 2+1 Daire">
                </div>
                <div class="form-group">
                    <label class="form-label">≈ûehir</label>
                    <input type="text" class="form-control" id="adCity" placeholder="√ñrn: Tunus">
                </div>
                <div class="form-group">
                    <label class="form-label">Semt</label>
                    <input type="text" class="form-control" id="adDistrict" placeholder="√ñrn: Kartaca">
                </div>

                <div class="form-group full-width">
                    <label class="form-label">üí∞ Fiyat ve Alan</label>
                </div>
                <div class="form-group">
                    <label class="form-label">Fiyat</label>
                    <input type="number" class="form-control" id="adPrice" placeholder="√ñrn: 500000">
                </div>
                <div class="form-group">
                    <label class="form-label">Alan (m¬≤)</label>
                    <input type="number" class="form-control" id="adArea" placeholder="√ñrn: 120">
                </div>

                <div class="form-group full-width">
                    <label class="form-label">üè† Detaylƒ± Bilgiler</label>
                </div>
                <div class="form-group">
                    <label class="form-label">Oda Sayƒ±sƒ±</label>
                    <select class="form-control" id="adRooms">
                        <option value="1+0">1+0 (St√ºdyo)</option>
                        <option value="2+1" selected>2+1</option>
                        <option value="3+1">3+1</option>
                        <option value="4+2">4+2</option>
                        <option value="5+">5+</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Bina Ya≈üƒ±</label>
                    <input type="number" class="form-control" id="adBuildingAge" placeholder="√ñrn: 5">
                </div>
                <div class="form-group">
                    <label class="form-label">Bulunduƒüu Kat</label>
                    <input type="text" class="form-control" id="adFloor" placeholder="√ñrn: 3/10">
                </div>
                <div class="form-group">
                    <label class="form-label">Isƒ±tma</label>
                    <select class="form-control" id="adHeating">
                        <option value="central">Merkezi</option>
                        <option value="combi">Kombi</option>
                        <option value="floor">Yerden Isƒ±tma</option>
                        <option value="ac">Klima</option>
                        <option value="none">Yok</option>
                    </select>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">üìù A√ßƒ±klama</label>
                </div>
                <div class="form-group full-width">
                    <textarea class="form-control" id="adDescription" placeholder="Emlak hakkƒ±nda detaylƒ± bilgi..."></textarea>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">üì∏ Fotoƒüraflar</label>
                    <div class="photo-upload-area" id="photo-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span>Fotoƒüraf eklemek i√ßin tƒ±kla</span>
                        <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;">
                    </div>
                    <div class="image-preview-container" id="image-preview-container"></div>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">üìû ƒ∞leti≈üim Bilgileri</label>
                </div>
                <div class="form-group">
                    <label class="form-label">ƒ∞sim</label>
                    <input type="text" class="form-control" id="adContactName" placeholder="Adƒ±nƒ±z Soyadƒ±nƒ±z">
                </div>
                <div class="form-group">
                    <label class="form-label">Telefon</label>
                    <input type="tel" class="form-control" id="adPhone" placeholder="+216 ...">
                </div>
                <div class="form-group">
                    <label class="form-label">E-posta</label>
                    <input type="email" class="form-control" id="adEmail" placeholder="ornek@email.com">
                </div>

                <div class="form-group full-width" style="display: flex; gap: 16px; justify-content: center;">
                    <button class="btn btn-primary" onclick="saveAd()"><i class="fas fa-save"></i> ƒ∞lanƒ± Kaydet</button>
                    <button class="btn btn-secondary" onclick="clearForm()"><i class="fas fa-undo"></i> Temizle</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>¬© 2026 Akarat Tunisia - T√ºm haklarƒ± saklƒ±dƒ±r.</p>
        </div>
    </footer>

    <!-- Modal'lar -->
    <!-- Detay Modalƒ± -->
    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2 id="modal-title"></h2>
                <button id="modal-favorite-btn" class="favorite-btn" onclick="toggleFavorite(currentAdId)"><i class="far fa-heart"></i></button>
            </div>
            <div id="modal-images" class="modal-image-gallery"></div>
            <div id="modal-info" class="modal-info"></div>
            <div id="modal-contact" class="contact-info hidden">
                <h4>üìû ƒ∞leti≈üim Bilgileri</h4>
                <p id="modal-contact-name"></p>
                <p id="modal-contact-phone"></p>
                <p id="modal-contact-email"></p>
            </div>
            <button class="btn btn-primary" style="margin-top: 16px;" onclick="showMessageModal()"><i class="fas fa-envelope"></i> Mesaj G√∂nder</button>
            <div id="modal-map"></div>
        </div>
    </div>

    <!-- Mesaj Modalƒ± -->
    <div id="message-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-modal" onclick="closeMessageModal()">&times;</span>
            <h2>Mesaj G√∂nder</h2>
            <textarea id="message-text" class="form-control" rows="4" placeholder="Mesajƒ±nƒ±z..."></textarea>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="sendMessage()">G√∂nder</button>
                <button class="btn btn-secondary" onclick="closeMessageModal()">ƒ∞ptal</button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-modal" onclick="closeLoginModal()">&times;</span>
            <h2>Giri≈ü Yap</h2>
            <div class="form-group">
                <label>E-posta</label>
                <input type="email" id="login-email" class="form-control">
            </div>
            <div class="form-group">
                <label>≈ûifre</label>
                <input type="password" id="login-password" class="form-control">
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="login()">Giri≈ü</button>
                <button class="btn btn-secondary" onclick="closeLoginModal()">ƒ∞ptal</button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-modal" onclick="closeRegisterModal()">&times;</span>
            <h2>Kayƒ±t Ol</h2>
            <div class="form-group">
                <label>Ad Soyad</label>
                <input type="text" id="register-name" class="form-control">
            </div>
            <div class="form-group">
                <label>E-posta</label>
                <input type="email" id="register-email" class="form-control">
            </div>
            <div class="form-group">
                <label>≈ûifre</label>
                <input type="password" id="register-password" class="form-control">
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="register()">Kayƒ±t</button>
                <button class="btn btn-secondary" onclick="closeRegisterModal()">ƒ∞ptal</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Dil √ßevirileri (sadece gerekli yerler)
        const translations = {
            tr: { /* T√ºrk√ße metinler */ },
            ar: { /* Arap√ßa metinler */ }
        };

        // Deƒüi≈ükenler
        let currentLanguage = 'tr'; // Varsayƒ±lan T√ºrk√ße
        let loggedInUser = null;
        let selectedImagesBase64 = [];
        let currentFilters = { priceMin: '', priceMax: '', city: '', district: '', type: '', rooms: '', buildingAge: '', floor: '', heating: '' };
        let currentAdId = null;
        let map = null;

        // Sayfa g√∂ster/gizle
        function showPage(page) {
            const pages = ['home', 'for-sale', 'for-rent', 'favorites', 'about', 'contact', 'myads', 'messages', 'profile', 'admin'];
            pages.forEach(p => {
                const el = document.getElementById(p + '-page');
                if (el) el.classList.add('hidden');
            });
            document.getElementById(page + '-page').classList.remove('hidden');

            // Filtre ve form g√∂r√ºn√ºrl√ºƒü√º
            const filterPanel = document.getElementById('filter-panel');
            const adForm = document.getElementById('ad-form-section');
            if (['home', 'for-sale', 'for-rent', 'favorites', 'myads'].includes(page)) {
                filterPanel.style.display = 'block';
                adForm.style.display = 'block';
            } else {
                filterPanel.style.display = 'none';
                adForm.style.display = 'none';
            }

            // Sayfa i√ßeriklerini doldur
            if (page === 'home') {
                loadHomePage();
            } else if (page === 'for-sale') {
                loadListings('sale', 'for-sale-container');
            } else if (page === 'for-rent') {
                loadListings('rent', 'for-rent-container');
            } else if (page === 'favorites') {
                loadFavorites();
            } else if (page === 'myads') {
                loadMyAds();
            } else if (page === 'messages') {
                loadMessages();
            } else if (page === 'profile') {
                updateProfile();
            } else if (page === 'admin' && loggedInUser?.isAdmin) {
                loadAdminPanel();
            } else if (page === 'contact') {
                setTimeout(() => initMap('contact-map'), 100);
            }
        }

        // Men√º aktiflik
        function setActiveMenu(menu) {
            const menus = ['home', 'for-sale', 'for-rent', 'favorites', 'about', 'contact'];
            menus.forEach(m => {
                const el = document.getElementById('menu-' + m);
                if (el) el.classList.remove('active');
            });
            const activeEl = document.getElementById('menu-' + menu);
            if (activeEl) activeEl.classList.add('active');
        }

        // Dil deƒüi≈ütirme
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.documentElement.lang = lang;
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
            // Sayfalarƒ± yenile
            if (!document.getElementById('home-page').classList.contains('hidden')) loadHomePage();
            if (!document.getElementById('for-sale-page').classList.contains('hidden')) loadListings('sale', 'for-sale-container');
            if (!document.getElementById('for-rent-page').classList.contains('hidden')) loadListings('rent', 'for-rent-container');
            if (!document.getElementById('favorites-page').classList.contains('hidden')) loadFavorites();
        }

        // Kullanƒ±cƒ± i≈ülemleri
        function showLoginModal() { document.getElementById('login-modal').classList.add('show'); }
        function closeLoginModal() { document.getElementById('login-modal').classList.remove('show'); }
        function showRegisterModal() { document.getElementById('register-modal').classList.add('show'); }
        function closeRegisterModal() { document.getElementById('register-modal').classList.remove('show'); }

        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                loggedInUser = user;
                updateUserUI();
                closeLoginModal();
                alert('Giri≈ü ba≈üarƒ±lƒ±!');
            } else {
                alert('E-posta veya ≈üifre hatalƒ±.');
            }
        }

        function register() {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            if (!name || !email || !password) return alert('T√ºm alanlarƒ± doldurun.');
            const users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.find(u => u.email === email)) return alert('Bu e-posta zaten kayƒ±tlƒ±!');
            const newUser = { id: Date.now(), name, email, password, isAdmin: users.length === 0 };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            loggedInUser = newUser;
            updateUserUI();
            closeRegisterModal();
            alert('Kayƒ±t ba≈üarƒ±lƒ±!');
        }

        function logout() {
            loggedInUser = null;
            updateUserUI();
            showPage('home');
        }

        function updateUserUI() {
            const auth = document.getElementById('auth-buttons');
            const userInfo = document.getElementById('user-info');
            if (loggedInUser) {
                auth.classList.add('hidden');
                userInfo.classList.remove('hidden');
                document.getElementById('username').innerText = loggedInUser.name;
                document.getElementById('admin-badge').classList.toggle('hidden', !loggedInUser.isAdmin);
                document.getElementById('admin-menu-item').classList.toggle('hidden', !loggedInUser.isAdmin);
                document.getElementById('menu-admin').classList.toggle('hidden', !loggedInUser.isAdmin);
            } else {
                auth.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        }

        // Favoriler
        function toggleFavorite(adId) {
            if (!loggedInUser) return alert('Giri≈ü yapƒ±n.');
            let favs = JSON.parse(localStorage.getItem('favorites')) || [];
            const index = favs.findIndex(f => f.adId === adId && f.userId === loggedInUser.id);
            if (index === -1) favs.push({ userId: loggedInUser.id, adId });
            else favs.splice(index, 1);
            localStorage.setItem('favorites', JSON.stringify(favs));
            if (currentAdId === adId) updateFavoriteButton();
            if (!document.getElementById('favorites-page').classList.contains('hidden')) loadFavorites();
        }

        function isFavorite(adId) {
            if (!loggedInUser) return false;
            const favs = JSON.parse(localStorage.getItem('favorites')) || [];
            return favs.some(f => f.adId === adId && f.userId === loggedInUser.id);
        }

        // Ana sayfayƒ± y√ºkle
        function loadHomePage() {
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            document.getElementById('stats-active').innerText = ads.length;
            document.getElementById('featured-ads-container').innerHTML = renderAds(ads.slice(0, 3));
            document.getElementById('sale-ads-container').innerHTML = renderAds(ads.filter(ad => ad.type === 'sale').slice(0, 3));
            document.getElementById('rent-ads-container').innerHTML = renderAds(ads.filter(ad => ad.type === 'rent').slice(0, 3));
        }

        // ƒ∞lanlarƒ± listele
        function loadListings(type, containerId) {
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const filtered = ads.filter(ad => ad.type === type);
            document.getElementById(containerId).innerHTML = renderAds(filtered);
        }

        // Favorileri y√ºkle
        function loadFavorites() {
            if (!loggedInUser) return showPage('home');
            const favs = JSON.parse(localStorage.getItem('favorites')) || [];
            const userFavIds = favs.filter(f => f.userId === loggedInUser.id).map(f => f.adId);
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const favAds = ads.filter(ad => userFavIds.includes(ad.id));
            document.getElementById('favorites-container').innerHTML = renderAds(favAds);
        }

        // ƒ∞lan render
        function renderAds(ads) {
            if (!ads.length) return '<p style="text-align: center; padding: 40px;">Hen√ºz ilan yok.</p>';
            return ads.map(ad => {
                const img = ad.images?.length ? `style="background-image: url('${ad.images[0]}')"` : '';
                const favClass = isFavorite(ad.id) ? 'active' : '';
                const actions = (loggedInUser && (ad.userId === loggedInUser.id || loggedInUser?.isAdmin)) ? `
                    <div class="ad-actions">
                        ${ad.userId === loggedInUser.id ? `<button onclick="editAd(${ad.id}); event.stopPropagation();"><i class="fas fa-edit"></i></button>` : ''}
                        <button onclick="deleteAd(${ad.id}); event.stopPropagation();"><i class="fas fa-trash"></i></button>
                    </div>
                ` : '';
                return `
                    <div class="ad-card" onclick="showDetail(${ad.id})">
                        <div class="ad-image" ${img}>
                            <button class="favorite-btn ${favClass}" onclick="toggleFavorite(${ad.id}); event.stopPropagation();">
                                <i class="fa${isFavorite(ad.id) ? 's' : 'r'} fa-heart"></i>
                            </button>
                        </div>
                        <div class="ad-content">
                            <h3 class="ad-title">${ad.title}</h3>
                            <div class="ad-location"><i class="fas fa-map-marker-alt"></i> ${ad.city || 'Tunus'} ${ad.district || ''}</div>
                            <div class="ad-price">${ad.price} TL</div>
                            <div class="ad-details">
                                <span><i class="fas fa-ruler-combined"></i> ${ad.area || '?'} m¬≤</span>
                                <span><i class="fas fa-bed"></i> ${ad.rooms || '2+1'}</span>
                                <span><i class="fas fa-calendar"></i> ${ad.date || ''}</span>
                            </div>
                        </div>
                        ${actions}
                    </div>
                `;
            }).join('');
        }

        // Fotoƒüraf y√ºkleme
        document.getElementById('photo-upload-area').addEventListener('click', () => document.getElementById('imageUpload').click());
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            for (let file of e.target.files) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        selectedImagesBase64.push(ev.target.result);
                        displayPreviews();
                    };
                    reader.readAsDataURL(file);
                }
            }
        });

        function displayPreviews() {
            const container = document.getElementById('image-preview-container');
            container.innerHTML = '';
            selectedImagesBase64.forEach((src, i) => {
                const div = document.createElement('div');
                div.className = 'preview-image-wrapper';
                div.innerHTML = `<img src="${src}" class="preview-image"><span class="remove-photo" onclick="removePhoto(${i})">&times;</span>`;
                container.appendChild(div);
            });
        }

        function removePhoto(index) {
            selectedImagesBase64.splice(index, 1);
            displayPreviews();
        }

        // ƒ∞lan kaydetme
        function saveAd() {
            if (!loggedInUser) return alert('Giri≈ü yapƒ±n.');
            const id = document.getElementById('editing-id').value;
            const ad = {
                id: id || Date.now(),
                userId: loggedInUser.id,
                type: document.getElementById('adType').value,
                title: document.getElementById('adTitle').value,
                city: document.getElementById('adCity').value,
                district: document.getElementById('adDistrict').value,
                price: document.getElementById('adPrice').value,
                area: document.getElementById('adArea').value,
                description: document.getElementById('adDescription').value,
                contactName: document.getElementById('adContactName').value || loggedInUser.name,
                phone: document.getElementById('adPhone').value,
                email: document.getElementById('adEmail').value || loggedInUser.email,
                rooms: document.getElementById('adRooms').value,
                buildingAge: document.getElementById('adBuildingAge').value,
                floor: document.getElementById('adFloor').value,
                heating: document.getElementById('adHeating').value,
                images: selectedImagesBase64,
                date: new Date().toLocaleDateString('tr-TR')
            };
            if (!ad.title || !ad.price || !ad.description) return alert('Zorunlu alanlarƒ± doldurun.');

            let ads = JSON.parse(localStorage.getItem('ads')) || [];
            if (id) {
                const index = ads.findIndex(a => a.id == id);
                if (index !== -1) ads[index] = ad;
            } else {
                ads.unshift(ad);
            }
            localStorage.setItem('ads', JSON.stringify(ads));
            clearForm();
            alert('ƒ∞lan kaydedildi!');
            // Sayfayƒ± yenile
            if (!document.getElementById('home-page').classList.contains('hidden')) loadHomePage();
            if (!document.getElementById('for-sale-page').classList.contains('hidden')) loadListings('sale', 'for-sale-container');
            if (!document.getElementById('for-rent-page').classList.contains('hidden')) loadListings('rent', 'for-rent-container');
        }

        function editAd(id) {
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const ad = ads.find(a => a.id === id);
            if (!ad || (ad.userId !== loggedInUser?.id && !loggedInUser?.isAdmin)) return;

            document.getElementById('editing-id').value = id;
            document.getElementById('adType').value = ad.type;
            document.getElementById('adTitle').value = ad.title;
            document.getElementById('adCity').value = ad.city || '';
            document.getElementById('adDistrict').value = ad.district || '';
            document.getElementById('adPrice').value = ad.price;
            document.getElementById('adArea').value = ad.area || '';
            document.getElementById('adDescription').value = ad.description;
            document.getElementById('adContactName').value = ad.contactName || '';
            document.getElementById('adPhone').value = ad.phone || '';
            document.getElementById('adEmail').value = ad.email || '';
            document.getElementById('adRooms').value = ad.rooms || '2+1';
            document.getElementById('adBuildingAge').value = ad.buildingAge || '';
            document.getElementById('adFloor').value = ad.floor || '';
            document.getElementById('adHeating').value = ad.heating || 'central';
            selectedImagesBase64 = ad.images ? [...ad.images] : [];
            displayPreviews();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function deleteAd(id) {
            if (!loggedInUser) return;
            if (!confirm('Silmek istediƒüinize emin misiniz?')) return;
            let ads = JSON.parse(localStorage.getItem('ads')) || [];
            ads = ads.filter(ad => !(ad.id === id && (ad.userId === loggedInUser.id || loggedInUser.isAdmin)));
            localStorage.setItem('ads', JSON.stringify(ads));
            // Sayfayƒ± yenile
            if (!document.getElementById('home-page').classList.contains('hidden')) loadHomePage();
            if (!document.getElementById('for-sale-page').classList.contains('hidden')) loadListings('sale', 'for-sale-container');
            if (!document.getElementById('for-rent-page').classList.contains('hidden')) loadListings('rent', 'for-rent-container');
            if (!document.getElementById('favorites-page').classList.contains('hidden')) loadFavorites();
        }

        function clearForm() {
            document.getElementById('editing-id').value = '';
            document.getElementById('adTitle').value = '';
            document.getElementById('adCity').value = '';
            document.getElementById('adDistrict').value = '';
            document.getElementById('adPrice').value = '';
            document.getElementById('adArea').value = '';
            document.getElementById('adDescription').value = '';
            document.getElementById('adContactName').value = '';
            document.getElementById('adPhone').value = '';
            document.getElementById('adEmail').value = '';
            selectedImagesBase64 = [];
            displayPreviews();
        }

        // Detay modalƒ±
        function showDetail(id) {
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const ad = ads.find(a => a.id === id);
            if (!ad) return;
            currentAdId = id;
            document.getElementById('modal-title').innerText = ad.title;

            const imgGallery = document.getElementById('modal-images');
            imgGallery.innerHTML = '';
            if (ad.images?.length) {
                ad.images.forEach(src => {
                    const img = document.createElement('img');
                    img.src = src;
                    imgGallery.appendChild(img);
                });
            } else {
                imgGallery.innerHTML = '<p>Fotoƒüraf yok</p>';
            }

            const info = `
                <p><strong>Tip:</strong> ${ad.type === 'sale' ? 'Satƒ±lƒ±k' : 'Kiralƒ±k'}</p>
                <p><strong>≈ûehir:</strong> ${ad.city || 'Tunus'}</p>
                <p><strong>Semt:</strong> ${ad.district || '-'}</p>
                <p><strong>Fiyat:</strong> ${ad.price} TL</p>
                <p><strong>Alan:</strong> ${ad.area || '?'} m¬≤</p>
                <p><strong>Oda:</strong> ${ad.rooms || '2+1'}</p>
                <p><strong>Bina Ya≈üƒ±:</strong> ${ad.buildingAge || '-'}</p>
                <p><strong>Kat:</strong> ${ad.floor || '-'}</p>
                <p><strong>Isƒ±tma:</strong> ${ad.heating ? {central:'Merkezi',combi:'Kombi',floor:'Yerden',ac:'Klima',none:'Yok'}[ad.heating] : '-'}</p>
                <p><strong>A√ßƒ±klama:</strong> ${ad.description}</p>
                <p><strong>Tarih:</strong> ${ad.date || ''}</p>
            `;
            document.getElementById('modal-info').innerHTML = info;

            if (loggedInUser) {
                document.getElementById('modal-contact').classList.remove('hidden');
                document.getElementById('modal-contact-name').innerHTML = `<strong>ƒ∞sim:</strong> ${ad.contactName || '-'}`;
                document.getElementById('modal-contact-phone').innerHTML = `<strong>Telefon:</strong> ${ad.phone || '-'}`;
                document.getElementById('modal-contact-email').innerHTML = `<strong>E-posta:</strong> ${ad.email || '-'}`;
            } else {
                document.getElementById('modal-contact').classList.add('hidden');
            }

            updateFavoriteButton();

            setTimeout(() => {
                if (map) map.remove();
                map = L.map('modal-map').setView([36.8065, 10.1815], 12);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
                L.marker([36.8065, 10.1815]).addTo(map).bindPopup(ad.city || 'Tunus').openPopup();
            }, 100);

            document.getElementById('detail-modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('detail-modal').classList.remove('show');
            if (map) map.remove();
        }

        function updateFavoriteButton() {
            const btn = document.getElementById('modal-favorite-btn');
            btn.innerHTML = isFavorite(currentAdId) ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
        }

        // Mesajlar
        function showMessageModal() {
            if (!loggedInUser) return alert('Giri≈ü yapƒ±n.');
            document.getElementById('message-modal').classList.add('show');
        }
        function closeMessageModal() {
            document.getElementById('message-modal').classList.remove('show');
        }
        function sendMessage() {
            const text = document.getElementById('message-text').value;
            if (!text) return alert('Mesaj yazƒ±n.');
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const ad = ads.find(a => a.id === currentAdId);
            if (!ad) return;
            const msgs = JSON.parse(localStorage.getItem('messages')) || [];
            msgs.push({ id: Date.now(), fromUserId: loggedInUser.id, toUserId: ad.userId, adId: currentAdId, text, date: new Date().toLocaleString(), read: false });
            localStorage.setItem('messages', JSON.stringify(msgs));
            closeMessageModal();
            alert('Mesaj g√∂nderildi.');
        }

        function loadMessages() {
            if (!loggedInUser) return showPage('home');
            const msgs = JSON.parse(localStorage.getItem('messages')) || [];
            const userMsgs = msgs.filter(m => m.toUserId === loggedInUser.id || m.fromUserId === loggedInUser.id);
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            const container = document.getElementById('messages-container');
            if (!userMsgs.length) {
                container.innerHTML = '<div style="padding: 40px; text-align: center;">Mesajƒ±nƒ±z yok.</div>';
                return;
            }
            container.innerHTML = userMsgs.map(m => {
                const from = users.find(u => u.id === m.fromUserId)?.name || 'Bilinmeyen';
                const ad = ads.find(a => a.id === m.adId)?.title || 'Bilinmeyen ƒ∞lan';
                return `<div style="padding: 16px; border-bottom: 1px solid #eef2f6;"><strong>${from}</strong> - ${ad}<br><small>${m.date}</small><p>${m.text}</p></div>`;
            }).join('');
        }

        // Harita
        function initMap(elementId) {
            if (map) map.remove();
            map = L.map(elementId).setView([36.8065, 10.1815], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            L.marker([36.8065, 10.1815]).addTo(map).bindPopup('Akarat Tunisia').openPopup();
        }

        // Admin paneli
        function loadAdminPanel() {
            if (!loggedInUser?.isAdmin) return;
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const ads = JSON.parse(localStorage.getItem('ads')) || [];
            document.getElementById('admin-users-container').innerHTML = users.map(u => `
                <div style="padding: 12px; border-bottom: 1px solid #eef2f6;">${u.name} (${u.email}) ${u.isAdmin ? 'üëë' : ''}</div>
            `).join('');
            document.getElementById('admin-ads-container').innerHTML = ads.map(a => {
                const user = users.find(u => u.id === a.userId)?.name || 'Bilinmeyen';
                return `<div style="padding: 12px; border-bottom: 1px solid #eef2f6;">${a.title} - ${a.price} TL (${user}) <button onclick="adminDeleteAd(${a.id})">Sil</button></div>`;
            }).join('');
        }

        function adminDeleteAd(id) {
            if (!loggedInUser?.isAdmin) return;
            if (!confirm('Silmek istediƒüinize emin misiniz?')) return;
            let ads = JSON.parse(localStorage.getItem('ads')) || [];
            ads = ads.filter(ad => ad.id !== id);
            localStorage.setItem('ads', JSON.stringify(ads));
            loadAdminPanel();
        }

        // Ba≈ülangƒ±√ß
        window.onload = function() {
            if (!localStorage.getItem('users')) {
                localStorage.setItem('users', JSON.stringify([
                    { id: 1, name: 'Admin', email: 'admin@example.com', password: 'admin123', isAdmin: true },
                    { id: 2, name: 'Ahmet', email: 'ahmet@example.com', password: '123456', isAdmin: false }
                ]));
            }
            if (!localStorage.getItem('ads')) localStorage.setItem('ads', JSON.stringify([]));
            if (!localStorage.getItem('favorites')) localStorage.setItem('favorites', JSON.stringify([]));
            if (!localStorage.getItem('messages')) localStorage.setItem('messages', JSON.stringify([]));

            showPage('home');
            setActiveMenu('home');
        };
    </script>
</body>
</html>
